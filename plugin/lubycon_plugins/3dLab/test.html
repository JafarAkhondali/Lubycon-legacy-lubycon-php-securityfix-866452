<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<!--<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />-->
	
	<script type="text/javascript" src="jquery-1.12.2.js"></script>
	<style>
		canvas {
			width: 100%;
			height: 90%;
		}
		#imgInput {
			position: fixed;
			top: 10px;
			left: 10px;
			color: #ffffff;
		}
		.testBtWrap {
			display: inline-block;
			position: fixed;
			top: 100px;
			left: 100px;
		}
		.testBt {
			position: relative;
			width: 100px;
			height: 50px;
			color: #ffffff;
			background: #444444;
			transition: background 0.4s;
			border: none;
			cursor: pointer;
		}
		.testBt:hover {
			background: #48cfad;
		}
	</style>
</head>
<body>
	<input type="file" id="imgInput" />
	<script type="text/javascript" src="three.min.js"></script>
	<script type="text/javascript" src="OrbitControls.js"></script>
	<script>
		//functions
		var windowWidth = window.innerWidth,
		windowHeight = window.innerHeight,
		funcs = {
			windowResize: function(){
				windowHalfX = window.innerWidth / 2,
				windowHalfY = window.innerHeight / 2,
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize(windowWidth,windowHeight);
			},
			objWidth: function(){
				var $this = $(this),
				$target = mesh;
				if($this.hasClass("selected")) $this.removeClass("selected"),$target.scale.set(1,1,1);
				else if(!$this.hasClass("selected")) $this.addClass("selected"),$target.scale.set(2,1,1);
			},
			distanceCamera: function(){
				var $this = $(this),
				$target = camera;
				if($this.hasClass("selected")) $this.removeClass("selected"),$target.position.z = 5;
				else if(!$this.hasClass("selected")) $this.addClass("selected"),$target.position.z = 10;
			},
			imgUpload: function(event){
				var $object = event.target.files;

				$.each($object, function(i,file){
	                var reader = new FileReader();
	                reader.readAsDataURL(file);
	                reader.onload = function(event){
	           			var material = new THREE.MeshPhongMaterial({
	           				map: THREE.ImageUtils.loadTexture(event.target.result)
	           			});
	           			mesh.material = material;
	                };
	            });
			}
		}

		//three.js
		var scene = new THREE.Scene(), //canvas scene
		camera = new THREE.PerspectiveCamera(75,windowWidth/windowHeight,0.1,1000),
		renderer = new THREE.WebGLRenderer(),
		object = new THREE.BoxGeometry( 1, 1, 1 ),
		mate = new THREE.MeshPhongMaterial({
			ambient: 0x48cfad, 
			color: 0x48cfad, 
			specular: 0xffffff, 
			shininess: 50, 
			shading: THREE.SmoothShading
		}),
		mesh = new THREE.Mesh(object,mate),
		aLight = new THREE.AmbientLight(0xffffff),
		dLight = new THREE.DirectionalLight( 0xffffff, 1),
		contorls = new THREE.OrbitControls(camera);

		dLight.position.set(-1,1,2);
		renderer.setSize(windowWidth, windowHeight);
		renderer.setPixelRatio(window.devicePixelRatio);
		$("body").append(renderer.domElement);
		scene.add(mesh);
		scene.add(dLight,aLight);
		camera.position.z = 5;

		window.addEventListener("resize", funcs.windowResize, false);

		function render() {
			requestAnimationFrame( render );
			mesh.rotation.x += 0.01;
			//mesh.rotation.y += 0.01;
			renderer.render( scene, camera );
		}
		render();

		//jqeury
		$("canvas").attr("id","webgl");
		var btwrap = $("<div/>",{
			"class" : "testBtWrap"
		}).appendTo("body")
		var cubeBt = $("<button/>",{
			"class" : "testBt",
			"html" : "Change width of object"
		}).on("click",funcs.objWidth).appendTo(btwrap);
		var cameraBt = $("<button/>",{
			"class" : "testBt",
			"html" : "Change position of camera"
		}).on("click",funcs.distanceCamera).appendTo(btwrap);

		$("#imgInput").on("change",funcs.imgUpload);

	</script>
</body>
</html>